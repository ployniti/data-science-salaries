# Company Size TABLE

The **company size** table holds the size of each company listing a job (Large, Medium, Small)

- Schema: group5
- Table: company_size
- Columns: size_id, size

[See Also: Acronyms & Definitions](../definitions/TABLE_OF_DEFINITIONS.md)

## CREATE TABLE Schema.COMPANY_SIZE

```sql
CREATE TABLE group5.company_size (
	size_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	size CHAR(1) NOT NULL UNIQUE
);

```

## Verify Tables Structure

```sql
\d+ group5.company_size
```

- Table Structure

```bash
                                               Table "group5.company_size"
 Column  |     Type     | Collation | Nullable |             Default              | Storage  | Stats target | Description
---------+--------------+-----------+----------+----------------------------------+----------+--------------+-------------
 size_id | integer      |           | not null | generated by default as identity | plain    |              |
 size    | character(1) |           | not null |                                  | extended |              |
Indexes:
    "company_size_pkey" PRIMARY KEY, btree (size_id)
    "company_size_size_key" UNIQUE CONSTRAINT, btree (size)
Access method: heap
```

## INSERT INTO Schema.Table

```sql
INSERT INTO group5.company_size (size) VALUES ('S'), ('M'), ('L');
```

- View Table

```sql
SELECT * FROM group5.company_size;
```

```bash
 size_id | size
---------+------
       1 | S
       2 | M
       3 | L
(3 rows)
```

## View of MAIN Table Before ALTER & UPDATE

```sql
SELECT * FROM group5.main LIMIT 5;
```

```bash
 listing_id | company_size | employee_residence |             job_title             | employment_type | experience_id | work_year_id | location_id | salary_id | remote_ratio_id
------------+--------------+--------------------+-----------------------------------+-----------------+---------------+--------------+-------------+-----------+-----------------
        342 | M            | US                 | Data Engineer                     | FT              |             3 |            1 |           2 |       103 |               1
         82 | M            | PT                 | Machine Learning Engineer         | FT              |             1 |            1 |           2 |        19 |               3
       1725 | M            | US                 | ML Engineer                       | FT              |             1 |            1 |           2 |       378 |               1
         83 | S            | IN                 | Applied Machine Learning Engineer | FT              |             2 |            1 |           4 |        83 |               3
         84 | L            | IN                 | AI Developer                      | FT              |             3 |            2 |           7 |        84 |               2
(5 rows)
```

## CREATE REFERENTIAL FROM MAIN TO NEW TABLE

- ADD Reference (id) Column to MAIN

```sql
ALTER TABLE group5.main ADD COLUMN size_id INT;
```

- Child Reference from MAIN Foreign Key to Parent Tables Primay Key (id)

```sql
UPDATE group5.main
SET size_id = company_size.size_id
FROM group5.company_size
WHERE group5.main.company_size = group5.company_size.size;

```

- Drop Unreferenced Column from MAIN

```sql
ALTER TABLE group5.main DROP COLUMN company_size;
```

- Add ON DELETE CASCADE to MAIN

```sql
ALTER TABLE group5.main
ADD CONSTRAINT size_fk_listing
FOREIGN KEY (size_id)
REFERENCES group5.company_size (size_id)
ON DELETE CASCADE;

```

## View of MAIN Table After ALTER & UPDATE

```sql
SELECT * FROM group5.main LIMIT 50;
```

```bash
 listing_id | employee_residence |         job_title         | employment_type | experience_id | work_year_id | location_id | salary_id | remote_ratio_id | size_id
------------+--------------------+---------------------------+-----------------+---------------+--------------+-------------+-----------+-----------------+---------
        122 | US                 | Machine Learning Engineer | FT              |             1 |            1 |           2 |       122 |               3 |       2
        123 | US                 | Machine Learning Engineer | FT              |             1 |            1 |           2 |       123 |               3 |       2
        124 | US                 | Analytics Engineer        | FT              |             1 |            1 |           2 |       118 |               1 |       2
        125 | US                 | Analytics Engineer        | FT              |             1 |            1 |           2 |       125 |               1 |       2
        126 | US                 | Data Engineer             | FT              |             1 |            1 |           2 |        86 |               1 |       2
        . . .
        . . .
        164 | US                 | Applied Scientist         | FT              |             1 |            1 |           2 |        69 |               1 |       3
        165 | US                 | Applied Scientist         | FT              |             1 |            1 |           2 |        70 |               1 |       3
        166 | US                 | Machine Learning Engineer | FT              |             1 |            1 |           2 |       166 |               1 |       2
        167 | US                 | Machine Learning Engineer | FT              |             1 |            1 |           2 |        19 |               1 |       2
        168 | US                 | Data Engineer             | FT              |             2 |            1 |           2 |        36 |               1 |       2
(5 rows)
```
