# Job Title TABLE

The **job title** table holds the postion title offered for each job listing

- Schema: group5
- Table: job_title
- Columns: title_id, title

## CREATE TABLE Schema.JOB_TITLE

```sql
CREATE TABLE group5.job_title (
	title_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	title VARCHAR(100) NOT NULL UNIQUE
);

```

## Verify Tables Structure

```sql
\d+ group5.job_title
```

- Table Structure

```bash
                                                      Table "group5.job_title"
  Column  |          Type          | Collation | Nullable |             Default              | Storage  | Stats target | Description
----------+------------------------+-----------+----------+----------------------------------+----------+--------------+-------------
 title_id | integer                |           | not null | generated by default as identity | plain    |              |
 title    | character varying(100) |           | not null |                                  | extended |              |
Indexes:
    "job_title_pkey" PRIMARY KEY, btree (title_id)
    "job_title_title_key" UNIQUE CONSTRAINT, btree (title)
Referenced by:
    TABLE "group5.main" CONSTRAINT "job_title_fk_listing" FOREIGN KEY (title_id) REFERENCES group5.job_title(title_id) ON DELETE CASCADE
Access method: heap
```

## INSERT INTO Schema.Table

- If you are unable to use the \copy function below, then follow [this link](../table_csv/job_title.txt) to use INSERT INTO data for this table. Simply copy and paste the data into your terminal.

[INSERT INTO: job_title.txt](../table_csv/job_title.txt)

## OR \copy Schema.Table Data

The job_title.csv is located in /table_csv: [CSV File Location](../table_csv/job_title.csv)

```sql
\copy group5.job_title (title) from job_title.csv with csv header
```

## View of Table

```sql
SELECT * FROM group5.job_title LIMIT 10;
```

```bash
 title_id |             title
----------+--------------------------------
        1 | Principal Data Scientist
        2 | ML Engineer
        4 | Data Scientist
        6 | Applied Scientist
       12 | Data Analyst
       16 | Data Modeler
       22 | Research Engineer
       24 | Analytics Engineer
       26 | Business Intelligence Engineer
       28 | Machine Learning Engineer
(10 rows)
```

## View of MAIN Table Before ALTER & UPDATE

```sql
SELECT * FROM group5.main LIMIT 5;
```

```bash
 listing_id | employee_residence |         job_title         | employment_type | experience_id | work_year_id | location_id | salary_id | remote_ratio_id | size_id
------------+--------------------+---------------------------+-----------------+---------------+--------------+-------------+-----------+-----------------+---------
        122 | US                 | Machine Learning Engineer | FT              |             1 |            1 |           2 |       122 |               3 |       2
        123 | US                 | Machine Learning Engineer | FT              |             1 |            1 |           2 |       123 |               3 |       2
        124 | US                 | Analytics Engineer        | FT              |             1 |            1 |           2 |       118 |               1 |       2
        125 | US                 | Analytics Engineer        | FT              |             1 |            1 |           2 |       125 |               1 |       2
        126 | US                 | Data Engineer             | FT              |             1 |            1 |           2 |        86 |               1 |       2
(5 rows)
```

## CREATE REFERENTIAL FROM MAIN TO NEW TABLE

- ADD Reference (id) Column to MAIN

```sql
ALTER TABLE group5.main ADD COLUMN title_id INT;
```

- Child Reference from MAIN Foreign Key to Parent Tables Primay Key (id)

```sql
UPDATE group5.main
SET title_id = job_title.title_id
FROM group5.job_title
WHERE group5.main.job_title = group5.job_title.title;

```

- Drop Unreferenced Column from MAIN

```sql
ALTER TABLE group5.main DROP COLUMN job_title;
```

- Add ON DELETE CASCADE to MAIN

```sql
ALTER TABLE group5.main
ADD CONSTRAINT job_title_fk_listing
FOREIGN KEY (title_id)
REFERENCES group5.job_title (title_id)
ON DELETE CASCADE;

```

## View of MAIN Table After ALTER & UPDATE

```sql
SELECT * FROM group5.main LIMIT 5;
```

```bash
i listing_id | employment_type | experience_id | work_year_id | location_id | salary_id | remote_ratio_id | size_id | residence_id | title_id
------------+-----------------+---------------+--------------+-------------+-----------+-----------------+---------+--------------+----------
        164 | FT              |             1 |            1 |           2 |        69 |               1 |       3 |            2 |        6
        165 | FT              |             1 |            1 |           2 |        70 |               1 |       3 |            2 |        6
        166 | FT              |             1 |            1 |           2 |       166 |               1 |       2 |            2 |       28
        167 | FT              |             1 |            1 |           2 |        19 |               1 |       2 |            2 |       28
        168 | FT              |             2 |            1 |           2 |        36 |               1 |       2 |            2 |       32
(5 rows)
```
